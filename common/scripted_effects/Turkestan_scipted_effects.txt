create_turkestani_faction = {
	if = {
		limit = {
			has_socialist_government = yes
			NOT = { tag = ALO }
		}
		create_faction = "Turkestani Popular Front"
	}
	else_if = {
		limit = {
			has_democratic_government = yes
			NOT = { tag = ALO }
		}
		create_faction = "Turkestani Democratic Alliance"
	}
	else_if = {
		limit = {
			has_dictatorship_government = yes
			NOT = { tag = ALO }
		}
		create_faction = "Turkestani Islamic Confederation"
	}
	else_if = {
		limit = {
			tag = ALO
		}
		create_faction = "Central Asian Confederation"
	}
	
}
TRK_setup_united_turkestan = {
	hidden_effect = {
		set_party_name = {
			ideology = totalist
			long_name = KYR_totalist_party_long
			name = KYR_totalist_party
		}
		set_party_name = {
			ideology = syndicalist
			long_name = KYR_syndicalist_party_long
			name = KYR_syndicalist_party
		}
		set_party_name = {
			ideology = radical_socialist
			long_name = TRK_united_socialist_party_long
			name = TRK_united_socialist_party
		}
		set_party_name = {
			ideology = social_democrat
			long_name = TRK_united_socialist_party_long
			name = TRK_united_socialist_party
		}
		if = {
			limit = {
				tag = KYR
			}
			set_party_name = {
				ideology = social_conservative
				long_name = KYR_authoritarian_democrat_party_long
				name = KYR_authoritarian_democrat_party
			}
			set_party_name = {
				ideology = authoritarian_democrat
				long_name = KYR_authoritarian_democrat_party_long
				name = KYR_authoritarian_democrat_party
			}
			create_country_leader = {
				name = "Mustafa Shokay"
				picture = "gfx/leaders/TRK/Portrait_TRK_Mustafa_Shokay.png"
				expire = "1965.1.1"
				ideology = social_liberal_subtype
			}

			create_country_leader = {
				name = "Mustafa Shokay"
				picture = "gfx/leaders/TRK/Portrait_TRK_Mustafa_Shokay.png"
				expire = "1965.1.1"
				ideology = market_liberal_subtype
			}
			create_country_leader = {
				name = "Serali Lapin"
				picture = "gfx/leaders/TRK/Portrait_TRK_Serali_Lapin.png"	
				expire = "1965.1.1"
				ideology = social_conservative_subtype
			}
			create_country_leader = {
				name = "Serali Lapin"
				picture = "gfx/leaders/TRK/Portrait_TRK_Serali_Lapin.png"
				expire = "1965.1.1"
				ideology = authoritarian_democrat_subtype
			}
		}
		else = {
			set_party_name = {
				ideology = social_liberal
				long_name = TRK_united_liberal_party_long
				name = TRK_united_liberal_party
			}
			set_party_name = {
				ideology = market_liberal
				long_name = TRK_united_liberal_party_long
				name = TRK_united_liberal_party
			}
			set_party_name = {
				ideology = social_conservative
				long_name = TRK_traditionalist_party_long
				name = TRK_traditionalist_party
			}
			set_party_name = {
				ideology = authoritarian_democrat
				long_name = TRK_traditionalist_party_long
				name = TRK_traditionalist_party
			}			
		}
		set_party_name = {
			ideology = national_populist
			long_name = TRK_national_populist_party_long
			name = TRK_national_populist_party
		}
		create_country_leader = {
			name = "Abdulkadyr Mukhitdinov"
					picture = "gfx/leaders/TRK/Portrait_TRK_Mukhitdinov.png"
			expire = "1965.1.1"
			ideology = totalist_subtype
		}
		create_country_leader = {
			name = "Torokul Dzhanuzakov"
			picture = "gfx/leaders/TRK/Portrait_TRK_Torokul_Dzhanuzakov.png"
			expire = "1965.1.1"
			ideology = agrarian_syndicalism_subtype 
		}
		create_country_leader = {
			name = "Fayzulla Khodjaev"
			picture = "gfx/leaders/TRK/Portrait_BUK_Fayzullah_Khodjaev.png"
			expire = "1965.1.1"
			ideology = agrarian_socialism_subtype 
		}
		create_country_leader = {
			name = "Usmon Khodja"
			picture = "gfx/leaders/TRK/Portrait_TRK_Usman_Hodzha.png"
			expire = "1965.1.1"
			ideology = socdem_democratic_socialism_subtype 
		}
		set_temp_variable = { TRK_tot_pop = KYR.party_popularity@totalist }
		add_to_temp_variable = { TRK_tot_pop = TRK.party_popularity@totalist }
		add_to_temp_variable = { TRK_tot_pop = UZB.party_popularity@totalist }
		divide_temp_variable = { TRK_tot_pop = 3 }
		multiply_temp_variable = { TRK_tot_pop = 100 }
		
		set_temp_variable = { TRK_syn_pop = KYR.party_popularity@syndicalist }
		add_to_temp_variable = { TRK_syn_pop = TRK.party_popularity@syndicalist }
		add_to_temp_variable = { TRK_syn_pop = UZB.party_popularity@syndicalist }
		divide_temp_variable = { TRK_syn_pop = 3 }
		multiply_temp_variable = { TRK_syn_pop = 100 }
		
		set_temp_variable = { TRK_rso_pop = KYR.party_popularity@radical_socialist }
		add_to_temp_variable = { TRK_rso_pop = TRK.party_popularity@radical_socialist }
		add_to_temp_variable = { TRK_rso_pop = UZB.party_popularity@radical_socialist }
		divide_temp_variable = { TRK_rso_pop = 3 }
		multiply_temp_variable = { TRK_rso_pop = 100 }
		
		set_temp_variable = { TRK_sde_pop = KYR.party_popularity@social_democrat }
		add_to_temp_variable = { TRK_sde_pop = TRK.party_popularity@social_democrat }
		add_to_temp_variable = { TRK_sde_pop = UZB.party_popularity@social_democrat }
		divide_temp_variable = { TRK_sde_pop = 3 }
		multiply_temp_variable = { TRK_sde_pop = 100 }
		
		set_temp_variable = { TRK_sli_pop = KYR.party_popularity@social_liberal }
		add_to_temp_variable = { TRK_sli_pop = TRK.party_popularity@social_liberal }
		add_to_temp_variable = { TRK_sli_pop = UZB.party_popularity@social_liberal }
		divide_temp_variable = { TRK_sli_pop = 3 }
		multiply_temp_variable = { TRK_sli_pop = 100 }
		
		set_temp_variable = { TRK_mli_pop = KYR.party_popularity@market_liberal }
		add_to_temp_variable = { TRK_mli_pop = TRK.party_popularity@market_liberal }
		add_to_temp_variable = { TRK_mli_pop = UZB.party_popularity@market_liberal }
		divide_temp_variable = { TRK_mli_pop = 3 }
		multiply_temp_variable = { TRK_mli_pop = 100 }
		
		set_temp_variable = { TRK_sco_pop = KYR.party_popularity@social_conservative }
		add_to_temp_variable = { TRK_sco_pop = TRK.party_popularity@social_conservative }
		add_to_temp_variable = { TRK_sco_pop = UZB.party_popularity@social_conservative }
		divide_temp_variable = { TRK_sco_pop = 3 }
		multiply_temp_variable = { TRK_sco_pop = 100 }
		
		set_temp_variable = { TRK_ade_pop = KYR.party_popularity@authoritarian_democrat }
		add_to_temp_variable = { TRK_ade_pop = TRK.party_popularity@authoritarian_democrat }
		add_to_temp_variable = { TRK_ade_pop = UZB.party_popularity@authoritarian_democrat }
		divide_temp_variable = { TRK_ade_pop = 3 }
		multiply_temp_variable = { TRK_ade_pop = 100 }
		
		set_temp_variable = { TRK_pau_pop = KYR.party_popularity@paternal_autocrat }
		add_to_temp_variable = { TRK_pau_pop = TRK.party_popularity@paternal_autocrat }
		add_to_temp_variable = { TRK_pau_pop = UZB.party_popularity@paternal_autocrat }
		divide_temp_variable = { TRK_pau_pop = 3 }
		multiply_temp_variable = { TRK_pau_pop = 100 }
		
		set_temp_variable = { TRK_npo_pop = KYR.party_popularity@national_populist }
		add_to_temp_variable = { TRK_npo_pop = TRK.party_popularity@national_populist }
		add_to_temp_variable = { TRK_npo_pop = UZB.party_popularity@national_populist }
		divide_temp_variable = { TRK_npo_pop = 3 }
		multiply_temp_variable = { TRK_npo_pop = 100 }
		
		set_political_party = {
			ideology = totalist
			popularity = TRK_tot_pop
		}
		set_political_party = {
			ideology = syndicalist
			popularity = TRK_syn_pop
		}
		set_political_party = {
			ideology = radical_socialist
			popularity = TRK_rso_pop
		}
		set_political_party = {
			ideology = social_democrat
			popularity = TRK_sde_pop
		}
		set_political_party = {
			ideology = social_liberal
			popularity = TRK_sli_pop
		}
		set_political_party = {
			ideology = social_conservative
			popularity = TRK_sco_pop
		}
		set_political_party = {
			ideology = authoritarian_democrat
			popularity = TRK_ade_pop
		}
		set_political_party = {
			ideology = paternal_autocrat
			popularity = TRK_pau_pop
		}
		set_political_party = {
			ideology = national_populist
			popularity = TRK_npo_pop
		}		
	}
}
TRK_setup_modernisation = {
	set_variable = { ROOT.political_modernisation = 0 }
	set_variable = { ROOT.economic_modernisation = 0 }
	set_variable = { ROOT.social_modernisation = 0 }
	
	
	set_variable = { ROOT.turkestan_stability = -0.2 } #political
	set_variable = { ROOT.turkestan_war_support = -0.2 } #political
	set_variable = { ROOT.turkestan_political_power = -0.25 } #political
	set_variable = { ROOT.turkestan_efficiency_gain = -0.1 } #economic
	set_variable = { ROOT.turkestan_construction_speed = -0.2 }  #economic
	set_variable = { ROOT.turkestan_research_speed = -0.2 }  #social
	set_variable = { ROOT.turkestan_monthly_population = -0.25 } #social
	
	TRK_setup_modernisation_for_each_tag = yes
}
TRK_setup_modernisation_for_each_tag = {
	add_dynamic_modifier = {
		modifier = turkestan_modernisation_modifier
	}
	
	hidden_effect = {
		if = {
			limit = { is_kokand_splinter_tag = yes }
			TRK_increase_political_modernisation = yes
			TRK_increase_political_modernisation = yes
			TRK_increase_economic_modernisation = yes
			TRK_increase_social_modernisation = yes
			TRK_increase_social_modernisation = yes
		}
		if = {
			limit = { tag = TRK }
			TRK_increase_economic_modernisation = yes
			TRK_increase_economic_modernisation = yes
			TRK_increase_social_modernisation = yes
		}
		if = {
			limit = { tag = UZB }
			TRK_increase_economic_modernisation = yes
		}
		if = {
			limit = { tag = ALO }
			TRK_increase_political_modernisation = yes
			TRK_increase_political_modernisation = yes
			TRK_increase_political_modernisation = yes
			TRK_increase_economic_modernisation = yes
			TRK_increase_social_modernisation = yes
			TRK_increase_social_modernisation = yes
			TRK_increase_social_modernisation = yes
		}
	}
}
TRK_increase_political_modernisation = {
	if = {
		limit = {
			check_variable = { ROOT.political_modernisation < 5 }
		}
		hidden_effect = {
			add_to_variable = { ROOT.political_modernisation = 1 }		
			clamp_variable = { var = ROOT.political_modernisation min = 0 max = 5 }
			
			add_to_variable = { ROOT.turkestan_stability = 0.05 } #political
			add_to_variable = { ROOT.turkestan_war_support = 0.05 } #political
			add_to_variable = { ROOT.turkestan_political_power = 0.05 } #political
			
			clamp_variable = { var = ROOT.turkestan_stability min = -0.25 max = 0 }
			clamp_variable = { var = ROOT.turkestan_war_support min = -0.25 max = 0 }
			clamp_variable = { var = ROOT.turkestan_political_power min = -0.25 max = 0 }
		}
	}
}
TRK_decrease_political_modernisation = {
	if = {
		limit = {
			check_variable = { ROOT.political_modernisation > 0 }
		}
		hidden_effect = {
			add_to_variable = { ROOT.political_modernisation = -1 }
			clamp_variable = { var = ROOT.political_modernisation min = 0 max = 5 }
			
			add_to_variable = { ROOT.turkestan_stability = -0.05 } #political
			add_to_variable = { ROOT.turkestan_war_support = -0.05 } #political
			add_to_variable = { ROOT.turkestan_political_power = -0.05 } #political
			
			clamp_variable = { var = ROOT.turkestan_stability min = -0.25 max = 0 }
			clamp_variable = { var = ROOT.turkestan_war_support min = -0.25 max = 0 }
			clamp_variable = { var = ROOT.turkestan_political_power min = -0.3 max = 0 }
		}
	}
}
TRK_increase_economic_modernisation = {
	if = {
		limit = {
			check_variable = { ROOT.economic_modernisation < 5 }
		}
		custom_effect_tooltip = TRK_increase_economic_modernisation
		hidden_effect = {
			add_to_variable = { ROOT.economic_modernisation = 1 }
			clamp_variable = { var = ROOT.economic_modernisation min = 0 max = 5 }
			
			add_to_variable = { ROOT.turkestan_efficiency_gain = 0.05 } #economic
			add_to_variable = { ROOT.turkestan_construction_speed = 0.05 }  #economic
			
			clamp_variable = { var = ROOT.turkestan_efficiency_gain min = -0.15 max = 0 }
			clamp_variable = { var = ROOT.turkestan_construction_speed min = -0.25 max = 0 }
		}
	}
}
TRK_decrease_economic_modernisation = {
	if = {
		limit = {
			check_variable = { ROOT.economic_modernisation > 0 }
		}
		custom_effect_tooltip = TRK_decrease_economic_modernisation
		hidden_effect = {
			add_to_variable = { ROOT.economic_modernisation = -1 }
			clamp_variable = { var = ROOT.economic_modernisation min = 0 max = 5 }
			
			add_to_variable = { ROOT.turkestan_efficiency_gain = -0.05 } #economic
			add_to_variable = { ROOT.turkestan_construction_speed = -0.05 }  #economic
			
			clamp_variable = { var = ROOT.turkestan_efficiency_gain min = -0.15 max = 0 }
			clamp_variable = { var = ROOT.turkestan_construction_speed min = -0.25 max = 0 }
		}
	}
}
TRK_increase_social_modernisation = {
	if = {
		limit = {
			check_variable = { ROOT.social_modernisation < 5 }
		}
		custom_effect_tooltip = TRK_increase_social_modernisation
		hidden_effect = {
			add_to_variable = { ROOT.social_modernisation = 1 }
			clamp_variable = { var = ROOT.social_modernisation min = 0 max = 5 }
			
			add_to_variable = { ROOT.turkestan_research_speed = 0.05 }  #social
			add_to_variable = { ROOT.turkestan_monthly_population = 0.05 } #social
			
			clamp_variable = { var = ROOT.turkestan_research_speed min = -0.25 max = 0 }
			clamp_variable = { var = ROOT.turkestan_monthly_population min = -0.3 max = 0 }
		}
	}
}
TRK_decrease_social_modernisation = {
	if = {
		limit = {
			check_variable = { ROOT.social_modernisation > 0 }
		}
		custom_effect_tooltip = TRK_decrease_social_modernisation
		hidden_effect = {
			add_to_variable = { ROOT.social_modernisation = -1 }
			clamp_variable = { var = ROOT.social_modernisation min = 0 max = 5 }
			
			add_to_variable = { ROOT.turkestan_research_speed = -0.05 }  #social
			add_to_variable = { ROOT.turkestan_monthly_population = -0.05 } #social
			
			clamp_variable = { var = ROOT.turkestan_research_speed min = -0.25 max = 0 }
			clamp_variable = { var = ROOT.turkestan_monthly_population min = -0.3 max = 0 }
		}
	}
}

determine_where_basmachi_should_go = {
	if = {
		limit = {
			ROOT = {
				NOT = { tag = UZB }
				is_neighbor_of = UZB
			}
			UZB = { has_government = authoritarian_democrat }
		}
		set_temp_variable = { target = UZB }
	}
	if = {
		limit = {
			ROOT = {
				NOT = { tag = TRK }
				is_neighbor_of = TRK
			}
			TRK = { has_dictatorship_government = yes }
		}
		set_temp_variable = { target = TRK }
	}
	else_if = {
		limit = {
			ROOT = {
				NOT = { tag = KYR }
				is_neighbor_of = KYR
			}
			KYR = { has_dictatorship_government = yes }
		}
		set_temp_variable = { target = KYR }
	}
	else_if = {
		limit = {
			ROOT = {
				NOT = { tag = TAJ }
				is_neighbor_of = TAJ
			}
			TAJ = { has_dictatorship_government = yes }
		}
		set_temp_variable = { target = TAJ }
	}
	else_if = {
		limit = {
			country_exists = AFG
			ROOT = { is_neighbor_of = AFG }
		}
		set_temp_variable = { target = AFG }
	}
	else_if = {
		limit = {
			country_exists = ETS
			ROOT = { is_neighbor_of = ETS }
		}
		set_temp_variable = { target = ETS }
	}
	else = {
		set_temp_variable = { target = XXA }
	}
}
basmachi_leave_region = {
	determine_where_basmachi_should_go = yes
	effect_tooltip = {
		every_unit_leader = {
			limit = {
				OR = {
					has_id = 68590
					has_id = 68591
					has_id = 68592
					has_id = 68593
					has_id = 68594
					has_id = 68595
					has_id = 68596
					has_id = 68598
					has_id = 68600
				}
			}
			retire = yes
		}
	}
	hidden_effect = {
		every_unit_leader = {
			limit = {
				OR = {
					has_id = 68590
					has_id = 68591
					has_id = 68592
					has_id = 68593
					has_id = 68594
					has_id = 68595
					has_id = 68596
					has_id = 68598
					has_id = 68600
				}
			}
			set_nationality = var:target
			add_unit_leader_trait = exiled_leader
			unit_leader_event = {
				id = turkestan.200
				days = 1
				random = 50
				random_days = 5
			}
		}
	}	
}
emir_leaves_bukhara = {
	random_unit_leader = { limit = { has_id = 68593 }
		set_nationality = AFG
		add_unit_leader_trait = exiled_leader
		unit_leader_event = {
			id = turkestan.201
			days = 1
			random = 50
			random_days = 5
		}
	}		
}

KYR_setup_mejlis = {
	set_variable = { turkestan_majlis_communist = 0 }
	set_variable = { turkestan_majlis_erk = 15 } #20
	set_variable = { turkestan_majlis_koshchi = 0 }
	set_variable = { turkestan_majlis_socialist = 0 }
	set_variable = { turkestan_majlis_socdem = 0 }
	set_variable = { turkestan_majlis_alash_socdem = 0 }
	set_variable = { turkestan_majlis_alash = 0 }
	set_variable = { turkestan_majlis_jadidist = 20 } #51
	set_variable = { turkestan_majlis_kadimist = 19 } #29
	set_variable = { turkestan_majlis_members = 54 } 
}
KYR_count_1936_elections = {
	set_temp_variable = { temp1 = KYR.party_popularity@radical_socialist }
	multiply_temp_variable = { temp1 = turkestan_majlis_members }
	set_temp_variable = { temp2 = 1 }
	subtract_from_temp_variable = { temp2 = party_popularity@totalist }
	subtract_from_temp_variable = { temp2 = party_popularity@syndicalist }
	subtract_from_temp_variable = { temp2 = party_popularity@social_democrat }
	subtract_from_temp_variable = { temp2 = party_popularity@market_liberal }
	subtract_from_temp_variable = { temp2 = party_popularity@social_conservative }
	subtract_from_temp_variable = { temp2 = party_popularity@paternal_autocrat }
	subtract_from_temp_variable = { temp2 = party_popularity@national_populist }
	divide_temp_variable = { temp1 = temp2 }
	set_variable = { turkestan_majlis_erk = temp1 }
	round_variable = turkestan_majlis_erk
	
	set_temp_variable = { temp1 = KYR.party_popularity@social_liberal }
	multiply_temp_variable = { temp1 = turkestan_majlis_members }
	set_temp_variable = { temp2 = 1 }
	subtract_from_temp_variable = { temp2 = party_popularity@totalist }
	subtract_from_temp_variable = { temp2 = party_popularity@syndicalist }
	subtract_from_temp_variable = { temp2 = party_popularity@social_democrat }
	subtract_from_temp_variable = { temp2 = party_popularity@market_liberal }
	subtract_from_temp_variable = { temp2 = party_popularity@social_conservative }
	subtract_from_temp_variable = { temp2 = party_popularity@paternal_autocrat }
	subtract_from_temp_variable = { temp2 = party_popularity@national_populist }
	divide_temp_variable = { temp1 = temp2 }
	set_variable = { turkestan_majlis_jadidist = temp1 }
	round_variable = turkestan_majlis_jadidist
	
	set_temp_variable = { temp1 = KYR.party_popularity@authoritarian_democrat }
	multiply_temp_variable = { temp1 = turkestan_majlis_members }
	set_temp_variable = { temp2 = 1 }
	subtract_from_temp_variable = { temp2 = party_popularity@totalist }
	subtract_from_temp_variable = { temp2 = party_popularity@syndicalist }
	subtract_from_temp_variable = { temp2 = party_popularity@social_democrat }
	subtract_from_temp_variable = { temp2 = party_popularity@market_liberal }
	subtract_from_temp_variable = { temp2 = party_popularity@social_conservative }
	subtract_from_temp_variable = { temp2 = party_popularity@paternal_autocrat }
	subtract_from_temp_variable = { temp2 = party_popularity@national_populist }
	divide_temp_variable = { temp1 = temp2 }
	set_variable = { turkestan_majlis_kadimist = temp1 }
	round_variable = turkestan_majlis_kadimist
}
UZB_start_border_war = {
	if = {
		limit = {
			FROM = { tag = ALO }
		}
		set_variable = { UZB.defender_state = 587 }
		set_variable = { UZB.attacker_state = 861 }
		start_border_war = {
			change_state_after_war = no
			attacker = {
				state = 861
				num_provinces = 3
				on_win = khiva.28
				on_lose = khiva.29
				on_cancel = khiva.30
				modifier = 0.2
			}	
			defender = {
				state = 587
				num_provinces = 3
				on_win = khiva.31
				on_lose = khiva.32
				on_cancel = khiva.31
			}
		}		
		set_border_war_data = {
			attacker = 861
			defender = 587
			attacker_modifier = 0.3
		}
	}
	if = {
		limit = {
			FROM = { tag = TRK }
		}
		set_variable = { UZB.defender_state = 1276 }
		set_variable = { UZB.attacker_state = 1275 }
		start_border_war = {
			change_state_after_war = no
			attacker = {
				state = 1275
				num_provinces = 2
				on_win = khiva.28
				on_lose = khiva.29
				on_cancel = khiva.30
				modifier = 0.2
			}	
			defender = {
				state = 1276
				num_provinces = 2
				on_win = khiva.31
				on_lose = khiva.32
				on_cancel = khiva.31
			}
		}
		set_border_war_data = {
			attacker = 1275
			defender = 1276
			attacker_modifier = 0.3
		}
	}
	if = {
		limit = {
			FROM = { 
				OR = {
					tag = TAJ
					tag = KYR
					tag = KRF
					tag = KRM
				}
			}
		}
		set_variable = { UZB.defender_state = 1278 }
		set_variable = { UZB.attacker_state = 861 }
		start_border_war = {
			change_state_after_war = no
			attacker = {
				state = 861
				num_provinces = 3
				on_win = khiva.28
				on_lose = khiva.29
				on_cancel = khiva.30
				modifier = 0.2
			}	
			defender = {
				state = 1278
				num_provinces = 2
				on_win = khiva.31
				on_lose = khiva.32
				on_cancel = khiva.31
			}
		}
		set_border_war_data = {
			attacker = 861
			defender = 1278
			attacker_modifier = 0.3
		}
	}
}
KYR_increase_kadimist_bop = {
	custom_effect_tooltip = KYR_increase_kadimist_bop
	hidden_effect = {
		set_temp_variable_to_random = KYR_random
		hidden_effect = {
			random_list = {
				seed = KYR_random
				25 = { add_to_variable = { turkestan_bop = -0.05 } }
				25 = { add_to_variable = { turkestan_bop = -0.07 } }
				25 = { add_to_variable = { turkestan_bop = -0.09 } }
				25 = { add_to_variable = { turkestan_bop = -0.11 } }
			}
			random = {
				chance = 10
				country_event = kyr.101
			}
		}
		add_popularity = {
			ideology = authoritarian_democrat
			popularity = 0.02
		}
	}
	KYR_increase_coalition_strength = yes
}
KYR_increase_jadidist_bop = {
	custom_effect_tooltip = KYR_increase_jadidist_bop
	hidden_effect = {
		random_list = {
			20 = { add_to_variable = { turkestan_bop = 0.05 } }
			30 = { add_to_variable = { turkestan_bop = 0.07 } }
			30 = { add_to_variable = { turkestan_bop = 0.09 } }
			20 = { add_to_variable = { turkestan_bop = 0.11 } }
		}
		add_popularity = {
			ideology = social_liberal
			popularity = 0.02
		}
	}
	KYR_decrease_coalition_strength = yes
}
KYR_decrease_coalition_strength = {
	if = {
		limit = { has_country_flag = KYR_secured_coalition }
		custom_effect_tooltip = KYR_secured_coalition_tt
	}
	else = {
		custom_effect_tooltip = KYR_decrease_coalition_strength
		hidden_effect = {
			random_list = {
				20 = { add_to_variable = { turkestan_coalition_stability = -0.1 } }
				30 = { add_to_variable = { turkestan_coalition_stability = -0.13 } }
				30 = { add_to_variable = { turkestan_coalition_stability = -0.15 } }
				20 = { add_to_variable = { turkestan_coalition_stability = -0.17 } }
			}
		}
		if = {
			limit = {
				NOT = { has_active_mission = KYR_kadimist_demands }
			}
			activate_mission = KYR_kadimist_demands
		}
		if = {
			limit = {
				check_variable = { turkestan_coalition_stability < 0 }
			}
			country_event = kyr.102
		}	
	}
}
KYR_increase_coalition_strength = {
	if = {
		limit = { has_country_flag = KYR_secured_coalition }
		custom_effect_tooltip = KYR_secured_coalition_tt
	}	
	else = {
		custom_effect_tooltip = KYR_increase_coalition_strength
		hidden_effect = {
			random_list = {
				20 = { add_to_variable = { turkestan_coalition_stability = 0.1 } }
				30 = { add_to_variable = { turkestan_coalition_stability = 0.13 } }
				30 = { add_to_variable = { turkestan_coalition_stability = 0.15 } }
				20 = { add_to_variable = { turkestan_coalition_stability = 0.17 } }
			}
		}
	}
}
KYR_setup_kyrgyzstan_splinter = {
	KRR = {
		transfer_technology_without_doctrines = yes
		transfer_state = 586
		add_state_core = 586
		set_capital = { state = 586 }
		copy_government_of_ROOT = yes
		set_politics = {
			ruling_party = social_democrat
			elections_allowed = no
		}
		add_popularity = {
			ideology = social_democrat
			popularity = 0.25
		}
		add_popularity = {
			ideology = radical_socialist
			popularity = 0.15
		}
		hidden_effect = {
			set_party_name = {
				ideology = totalist
				name = KYR_totalist_party
				long_name = KYR_totalist_party_long
			}
			set_party_name = {
				ideology = syndicalist
				name = KYR_syndicalist_party
				long_name = KYR_syndicalist_party_long
			}
			set_party_name = {
				ideology = radical_socialist
				name = KYR_alash_party
				long_name = KYR_alash_party_long
			}
			set_party_name = {
				ideology = social_democrat
				name = KYR_alash_party
				long_name = KYR_alash_party_long
			}
			set_party_name = {
				ideology = social_liberal
				name = KYR_alash_party
				long_name = KYR_alash_party_long
			}
			set_party_name = {
				ideology = market_liberal
				name = KYR_alash_party
				long_name = KYR_alash_party_long
			}
			set_party_name = {
				ideology = social_conservative
				name = KYR_alash_party
				long_name = KYR_alash_party_long
			}
			set_party_name = {
				ideology = authoritarian_democrat
				name = KYR_authoritarian_democrat
				long_name = KYR_authoritarian_democrat_party_long
			}
			set_party_name = {
				ideology = paternal_autocrat
				name = KYR_paternal_autocrat_party
				long_name = KYR_paternal_autocrat_party_long
			}
			set_party_name = {
				ideology = national_populist
				name = KYR_national_populist_party
				long_name = KYR_national_populist_party_long
			}
		}
		create_country_leader = {
			name = "Abdykerim Sadykov"
			picture = "gfx/leaders/TRK/Portrait_TRK_Abdykerim_Sadykov.png"
			expire = "1965.1.1"
			ideology = left_nationalism_subtype
		}
		random_owned_controlled_state = {
			create_unit = {
				division = "division_template = \"Piyade Tümeni\" start_experience_factor = 0.2"
				owner = PREV
			}
			create_unit = {
				division = "division_template = \"Piyade Tümeni\" start_experience_factor = 0.2"
				owner = PREV
			}
			create_unit = {
				division = "division_template = \"Piyade Tümeni\" start_experience_factor = 0.1"
				owner = PREV
			}
		}
	}			
}
KYR_setup_shokay_cw = {
	KRF = {
		transfer_state = 1278
		transfer_state = 407
		transfer_state = 585
		transfer_state = 712
		add_state_core = 1278
		add_state_core = 407
		add_state_core = 585
		add_state_core = 712
		set_capital = { state = 407 }
		copy_government_of_ROOT = yes
		set_politics = {
			ruling_party = social_liberal
			elections_allowed = no
		}
		add_popularity = {
			ideology = social_liberal
			popularity = 0.25
		}
		hidden_effect = {
			set_party_name = {
				ideology = totalist
				name = KYR_totalist_party
				long_name = KYR_totalist_party_long
			}
			set_party_name = {
				ideology = syndicalist
				name = KYR_syndicalist_party
				long_name = KYR_syndicalist_party_long
			}
			set_party_name = {
				ideology = radical_socialist
				name = KYR_radical_socialist_party
				long_name = KYR_radical_socialist_party_long
			}
			set_party_name = {
				ideology = social_democrat
				name = KYR_social_democrat_party
				long_name = KYR_social_democrat_party_long
			}
			set_party_name = {
				ideology = social_liberal
				name = KYR_market_liberal_party
				long_name = KYR_market_liberal_party_long
			}
			set_party_name = {
				ideology = market_liberal
				name = KYR_market_liberal_party
				long_name = KYR_market_liberal_party_long
			}
			set_party_name = {
				ideology = social_conservative
				name = KYR_social_conservative_party
				long_name = KYR_social_conservative_party_long
			}
			set_party_name = {
				ideology = authoritarian_democrat
				name = KYR_authoritarian_democrat
				long_name = KYR_authoritarian_democrat_party_long
			}
			set_party_name = {
				ideology = paternal_autocrat
				name = KYR_paternal_autocrat_party
				long_name = KYR_paternal_autocrat_party_long
			}
			set_party_name = {
				ideology = national_populist
				name = KYR_national_populist_party
				long_name = KYR_national_populist_party_long
			}
		}
		random_owned_controlled_state = {
			create_unit = {
				division = "division_template = \"Piyade Tümeni\" start_experience_factor = 0.2"
				owner = PREV
			}
			create_unit = {
				division = "division_template = \"Piyade Tümeni\" start_experience_factor = 0.2"
				owner = PREV
			}
			create_unit = {
				division = "division_template = \"Piyade Tümeni II\" start_experience_factor = 0.2"
				owner = PREV
			}
		}
		declare_war_on = {
			target = ROOT
			type = civil_war
		}
		declare_war_on = {
			target = TAJ
			type = civil_war
		}
	}			
}
KYR_setup_monstrov_cw = {
	KRM = {
		transfer_technology_without_doctrines = yes
		set_country_flag = KR_set_up_ai_templates
		1279 = { 
			transfer_state_to = PREV
			add_core_of = PREV
		}
		set_capital = { state = 1279 }
		division_template = {
			name = "Krestyanskiye Otryady"
			division_names_group = RUS_MIL_01

			regiments = {
				irregular_infantry = { x = 0 y = 0 }
				irregular_infantry = { x = 0 y = 1 }
				irregular_infantry = { x = 0 y = 2 }
				irregular_infantry = { x = 1 y = 0 }
				irregular_infantry = { x = 1 y = 1 }
				irregular_infantry = { x = 1 y = 2 }
				irregular_infantry = { x = 2 y = 0 }
				irregular_infantry = { x = 2 y = 1 }
				irregular_infantry = { x = 2 y = 2 }
			}
		}
		hidden_effect = {
			set_party_name = {
				ideology = totalist
				name = KYR_totalist_party
				long_name = KYR_totalist_party_long
			}
			set_party_name = {
				ideology = syndicalist
				name = KYR_syndicalist_party
				long_name = KYR_syndicalist_party_long
			}
			set_party_name = {
				ideology = radical_socialist
				name = KYR_radical_socialist_party
				long_name = KYR_radical_socialist_party_long
			}
			set_party_name = {
				ideology = social_democrat
				name = KYR_social_democrat_party
				long_name = KYR_social_democrat_party_long
			}
			set_party_name = {
				ideology = social_liberal
				name = KYR_market_liberal_party
				long_name = KYR_market_liberal_party_long
			}
			set_party_name = {
				ideology = market_liberal
				name = KYR_market_liberal_party
				long_name = KYR_market_liberal_party_long
			}
			set_party_name = {
				ideology = social_conservative
				name = KYR_social_conservative_party
				long_name = KYR_social_conservative_party_long
			}
			set_party_name = {
				ideology = authoritarian_democrat
				name = KYR_authoritarian_democrat
				long_name = KYR_authoritarian_democrat_party_long
			}
			set_party_name = {
				ideology = paternal_autocrat
				name = KYR_peasant_army
				long_name = KYR_peasant_army_long
			}
			set_party_name = {
				ideology = national_populist
				name = KYR_peasant_army
				long_name = KYR_peasant_army_long
			}
			UZB = {
				country_event = {
					id = khiva.6
					days = 3
				}
			}
		}
		copy_government_of_ROOT = yes
		set_politics = {
			ruling_party = paternal_autocrat
			elections_allowed = no
		}
		add_popularity = {
			ideology = paternal_autocrat
			popularity = 0.25
		}
		1279 = {
			create_unit = {
				division = "division_template = \"Krestyanskiye Otryady\" start_experience_factor = 0.1"
				allow_spawning_on_enemy_provs = yes
				prioritize_location = 14731
				owner = PREV
			}
			create_unit = {
				division = "division_template = \"Krestyanskiye Otryady\" start_experience_factor = 0.1"
				allow_spawning_on_enemy_provs = yes
				prioritize_location = 14731
				owner = PREV
			}
			create_unit = {
				division = "division_template = \"Krestyanskiye Otryady\" start_experience_factor = 0.1"
				allow_spawning_on_enemy_provs = yes
				prioritize_location = 14727
				owner = PREV
			}
			add_victory_points = {
				province = 14731
				value = 5
			}
			add_victory_points = {
				province = 14732
				value = -2
			}
		}
	}
	hidden_effect = {
		set_province_controller = 14735
		set_province_controller = 14730
		set_province_controller = 14729
		set_province_controller = 14728
		set_province_controller = 14734
		set_province_controller = 14733
		set_province_controller = 14740
		set_province_controller = 14732
	}
}
UZB_increase_identity = {
	add_to_variable = { UZB.eshi_khan_influence = 1 }
	clamp_variable = {
		var = UZB.eshi_khan_influence
		min = 0
		max = 10
	}		
	if = {
		limit = {
			has_idea = UZB_many_sons_of_oghuz_9
		}
		increase_ruling_party_popularity_by_2 = yes
	}
	else_if = {
		limit = {
			has_idea = UZB_many_sons_of_oghuz_8
		}
		swap_ideas = {
			remove_idea = UZB_many_sons_of_oghuz_8
			add_idea = UZB_many_sons_of_oghuz_9
		}
	}
	else_if = {
		limit = {
			has_idea = UZB_many_sons_of_oghuz_7
		}
		swap_ideas = {
			remove_idea = UZB_many_sons_of_oghuz_7
			add_idea = UZB_many_sons_of_oghuz_8
		}
	}
	else_if = {
		limit = {
			has_idea = UZB_many_sons_of_oghuz_6
		}
		swap_ideas = {
			remove_idea = UZB_many_sons_of_oghuz_6
			add_idea = UZB_many_sons_of_oghuz_7
		}
	}
	else_if = {
		limit = {
			has_idea = UZB_many_sons_of_oghuz_5
		}
		swap_ideas = {
			remove_idea = UZB_many_sons_of_oghuz_5
			add_idea = UZB_many_sons_of_oghuz_6
		}
	}
	else_if = {
		limit = {
			has_idea = UZB_many_sons_of_oghuz_4
		}
		swap_ideas = {
			remove_idea = UZB_many_sons_of_oghuz_4
			add_idea = UZB_many_sons_of_oghuz_5
		}
	}
	else_if = {
		limit = {
			has_idea = UZB_many_sons_of_oghuz_3
		}
		swap_ideas = {
			remove_idea = UZB_many_sons_of_oghuz_3
			add_idea = UZB_many_sons_of_oghuz_4
		}
	}
	else_if = {
		limit = {
			has_idea = UZB_many_sons_of_oghuz_2
		}
		swap_ideas = {
			remove_idea = UZB_many_sons_of_oghuz_2
			add_idea = UZB_many_sons_of_oghuz_3
		}
	}
	else_if = {
		limit = {
			has_idea = UZB_many_sons_of_oghuz_1
		}
		swap_ideas = {
			remove_idea = UZB_many_sons_of_oghuz_1
			add_idea = UZB_many_sons_of_oghuz_2
		}
	}
	else_if = {
		limit = {
			has_idea = UZB_many_sons_of_oghuz
		}
		swap_ideas = {
			remove_idea = UZB_many_sons_of_oghuz
			add_idea = UZB_many_sons_of_oghuz_1
		}
	}	
}
UZB_decrease_identity = {
	add_to_variable = { UZB.eshi_khan_influence = -1 }
	clamp_variable = {
		var = UZB.eshi_khan_influence
		min = 0
		max = 10
	}		
	if = {
		limit = {
			has_idea = UZB_many_sons_of_oghuz_9
		}
		swap_ideas = {
			remove_idea = UZB_many_sons_of_oghuz_9
			add_idea = UZB_many_sons_of_oghuz_8
		}
	}
	else_if = {
		limit = {
			has_idea = UZB_many_sons_of_oghuz_8
		}
		swap_ideas = {
			remove_idea = UZB_many_sons_of_oghuz_8
			add_idea = UZB_many_sons_of_oghuz_7
		}
	}
	else_if = {
		limit = {
			has_idea = UZB_many_sons_of_oghuz_7
		}
		swap_ideas = {
			remove_idea = UZB_many_sons_of_oghuz_7
			add_idea = UZB_many_sons_of_oghuz_6
		}
	}
	else_if = {
		limit = {
			has_idea = UZB_many_sons_of_oghuz_6
		}
		swap_ideas = {
			remove_idea = UZB_many_sons_of_oghuz_6
			add_idea = UZB_many_sons_of_oghuz_5
		}
	}
	else_if = {
		limit = {
			has_idea = UZB_many_sons_of_oghuz_5
		}
		swap_ideas = {
			remove_idea = UZB_many_sons_of_oghuz_5
			add_idea = UZB_many_sons_of_oghuz_4
		}
	}
	else_if = {
		limit = {
			has_idea = UZB_many_sons_of_oghuz_4
		}
		swap_ideas = {
			remove_idea = UZB_many_sons_of_oghuz_4
			add_idea = UZB_many_sons_of_oghuz_3
		}
	}
	else_if = {
		limit = {
			has_idea = UZB_many_sons_of_oghuz_3
		}
		swap_ideas = {
			remove_idea = UZB_many_sons_of_oghuz_3
			add_idea = UZB_many_sons_of_oghuz_2
		}
	}
	else_if = {
		limit = {
			has_idea = UZB_many_sons_of_oghuz_2
		}
		swap_ideas = {
			remove_idea = UZB_many_sons_of_oghuz_2
			add_idea = UZB_many_sons_of_oghuz_1
		}
	}
	else_if = {
		limit = {
			has_idea = UZB_many_sons_of_oghuz_1
		}
		swap_ideas = {
			remove_idea = UZB_many_sons_of_oghuz_1
			add_idea = UZB_many_sons_of_oghuz
		}
	}
	else_if = {
		limit = {
			has_idea = UZB_many_sons_of_oghuz
		}
		add_stability = -0.05
	}
}

TRK_change_centralisation = {
	if = {
		limit = { 
			has_country_flag = TRK_centralisation_of_emirate
			TRK_alim_khan_in_power = yes 
		}
		# convert percent to absolute
		if = {
			limit = {
				check_variable = { TRK_centralisation_change > -1 }
				check_variable = { TRK_centralisation_change < 1 }
			}
			multiply_temp_variable = { TRK_centralisation_change = 100 }
		}

		# tooltip
		effect_tooltip = {
			add_to_variable = {
				TRK_centralisation = TRK_centralisation_change
				tooltip = TRK_centralisation_tooltip
			}
		}

		# lower limit = legitimacy * -1
		set_temp_variable = { TRK_lower_limit = TRK_centralisation }
		multiply_temp_variable = { TRK_lower_limit = -1 }

		# upper limit = 100 - legitimacy
		set_temp_variable = { TRK_upper_limit = 100 }
		subtract_from_temp_variable = { TRK_upper_limit = TRK_centralisation }

		# avoid values outside the allowed range
		clamp_temp_variable = {
			var = TRK_centralisation_change
			min = TRK_lower_limit
			max = TRK_upper_limit
		}

		# add the variable
		add_to_variable = { TRK_centralisation = TRK_centralisation_change }
	}
}
TRK_change_decentralisation = {
	if = {
		limit = { 
			has_country_flag = TRK_decentralisation_of_emirate
			TRK_alim_khan_in_power = yes 
		}
		# convert percent to absolute
		if = {
			limit = {
				check_variable = { TRK_decentralisation_change > -1 }
				check_variable = { TRK_decentralisation_change < 1 }
			}
			multiply_temp_variable = { TRK_decentralisation_change = 100 }
		}

		# tooltip
		effect_tooltip = {
			add_to_variable = {
				TRK_decentralisation = TRK_decentralisation_change
				tooltip = TRK_decentralisation_tooltip
			}
		}

		# lower limit = legitimacy * -1
		set_temp_variable = { TRK_lower_limit = TRK_decentralisation }
		multiply_temp_variable = { TRK_lower_limit = -1 }

		# upper limit = 100 - legitimacy
		set_temp_variable = { TRK_upper_limit = 100 }
		subtract_from_temp_variable = { TRK_upper_limit = TRK_decentralisation }

		# avoid values outside the allowed range
		clamp_temp_variable = {
			var = TRK_decentralisation_change
			min = TRK_lower_limit
			max = TRK_upper_limit
		}

		# add the variable
		add_to_variable = { TRK_decentralisation = TRK_decentralisation_change }
	}
}
TRK_increase_kushbegi = {
	custom_effect_tooltip = TRK_increase_kushbegi
	add_to_variable = { TRK_kushbegi = 1 }
	add_to_variable = { TRK_karaulbegi = -1 }
}
TRK_increase_karaulbegi = {
	custom_effect_tooltip = TRK_increase_karaulbegi
	add_to_variable = { TRK_karaulbegi = 1 }
	add_to_variable = { TRK_kushbegi = -1 }
}
TRK_decrease_kushbegi = {
	custom_effect_tooltip = TRK_decrease_kushbegi
	add_to_variable = { TRK_kushbegi = -1 }
	add_to_variable = { TRK_karaulbegi = 1 }
}
TRK_decrease_karaulbegi = {
	custom_effect_tooltip = TRK_decrease_karaulbegi
	add_to_variable = { TRK_karaulbegi = -1 }
	add_to_variable = { TRK_kushbegi = 1 }
}
TRK_increase_reformists = {
	if = {
		limit = {
			NOT = { has_country_flag = TRK_antireformist_coup }
		}
		custom_effect_tooltip = TRK_increase_reformists
		add_to_variable = { TRK_reformists = 1 }
	}
}
TRK_decrease_reformists = {
	if = {
		limit = {
			NOT = { has_country_flag = TRK_antireformist_coup }
		}
		custom_effect_tooltip = TRK_decrease_reformists
		add_to_variable = { TRK_reformists = -1 }
	}
}
TRK_closer_to_chaos = {
	if = {
		limit = {
			TRK_alim_khan_in_power = yes
		}
		if = {
			limit = {
				check_variable = { TRK_chaos > 3 }
			}
			custom_effect_tooltip = TRK_closer_to_chaos_yellow
			add_to_variable = { TRK_chaos = -1 }
		}
		else_if = {
			limit = {
				check_variable = { TRK_chaos < 4 }
				check_variable = { TRK_chaos > 1 }
			}
			custom_effect_tooltip = TRK_closer_to_chaos_red
			add_to_variable = { TRK_chaos = -1 }
		}
		else = {
			custom_effect_tooltip = TRK_closer_to_chaos_dead
			add_to_variable = { TRK_chaos = -1 }
			if = {
				limit = {
					has_country_flag = TRK_young_bukhara_radical
					OR = {
						is_ai = no
						AND = {
							is_ai = yes
							NOT = {
								has_game_rule = {
									rule = TRK_PATH
									option = TRK_PATH_ABS_MON
								}
								has_game_rule = {
									rule = TRK_PATH
									option = TRK_PATH_ABS_MON_IBRAHIM
								}
							}
						}
					}
				}
				hidden_effect = {
					country_event = {
						id = bukhara.50
						days = 2
					}
				}
			}
			else_if = {
				limit = {
					OR = {
						is_ai = no
						AND = {
							is_ai = yes
							NOT = {
								has_game_rule = {
									rule = TRK_PATH
									option = TRK_PATH_ABS_MON
								}
								has_game_rule = {
									rule = TRK_PATH
									option = TRK_PATH_ABS_MON_IBRAHIM
								}
							}
						}
					}
				}
				hidden_effect = {
					country_event = {
						id = bukhara.15
						days = 2
					}
				}
			}
		}
	}
}

TRK_decrease_largest_begi = {
	if = {
		limit = { 
			check_variable = { TRK_karaulbegi > TRK_kushbegi }
		}
		TRK_decrease_karaulbegi = yes
	}
	else = {
		TRK_decrease_kushbegi = yes
	}
}
TRK_decrease_black_monday = {
	custom_effect_tooltip = TRK_decrease_black_monday
	hidden_effect = {
		if = {
			limit = { has_idea = TRK_black_monday_4 }
			remove_ideas = TRK_black_monday_4
			add_timed_idea = {
				idea = TRK_black_monday_5
				days = 365
			}
		}
		else_if = {
			limit = { has_idea = TRK_black_monday_3 }
			swap_ideas = {
				remove_idea = TRK_black_monday_3
				add_idea = TRK_black_monday_4
			}
		}
		else_if = {
			limit = { has_idea = TRK_black_monday_2 }
			swap_ideas = {
				remove_idea = TRK_black_monday_2
				add_idea = TRK_black_monday_3
			}
		}
		else_if = {
			limit = { has_idea = TRK_black_monday_1 }
			swap_ideas = {
				remove_idea = TRK_black_monday_1
				add_idea = TRK_black_monday_2
			}
		}
		else_if = {
			limit = { has_idea = TRK_black_monday }
			swap_ideas = {
				remove_idea = TRK_black_monday
				add_idea = TRK_black_monday_1
			}
		}
	}
}	
	
TRK_decrease_hegemony_nationalization = {
	if = {
		limit = { has_idea = TRK_russian_economic_hegemony_karaulbegi_embargo }
		swap_ideas = {
			remove_idea = TRK_russian_economic_hegemony_karaulbegi_embargo
			add_idea = TRK_russian_economic_hegemony_karaulbegi_embargo_nationaliation
		}
	}
	else_if = {
		limit = { has_idea = TRK_russian_economic_hegemony_karaulbegi }
		swap_ideas = {
			remove_idea = TRK_russian_economic_hegemony_karaulbegi
			add_idea = TRK_russian_economic_hegemony_karaulbegi_nationalization
		}
	}
	else_if = {
		limit = { has_idea = TRK_russian_economic_hegemony_1_taxes }
		swap_ideas = {
			remove_idea = TRK_russian_economic_hegemony_1_taxes
			add_idea = TRK_russian_economic_hegemony_1_taxes_nationalization
		}
	}
	else_if = {
		limit = { has_idea = TRK_russian_economic_hegemony_1 }
		swap_ideas = {
			remove_idea = TRK_russian_economic_hegemony_1
			add_idea = TRK_russian_economic_hegemony_1_nationalization
		}
	}
}
TRK_decrease_hegemony_taxes = {
	if = {
		limit = { has_idea = TRK_russian_economic_hegemony_1_taxes }
		swap_ideas = {
			remove_idea = TRK_russian_economic_hegemony_1_taxes
			add_idea = TRK_russian_economic_hegemony_2_taxes
		}
	}
	else_if = {
		limit = { has_idea = TRK_russian_economic_hegemony_1_taxes_nationalization }
		swap_ideas = {
			remove_idea = TRK_russian_economic_hegemony_1_taxes_nationalization
			add_idea = TRK_russian_economic_hegemony_2_taxes_nationalization
		}
	}
	else_if = {
		limit = { has_idea = TRK_russian_economic_hegemony_1 }
		swap_ideas = {
			remove_idea = TRK_russian_economic_hegemony_1
			add_idea = TRK_russian_economic_hegemony_1_taxes
		}
	}
	else_if = {
		limit = { has_idea = TRK_russian_economic_hegemony_karaulbegi }
		swap_ideas = {
			remove_idea = TRK_russian_economic_hegemony_karaulbegi
			add_idea = TRK_russian_economic_hegemony_karaulbegi_taxes
		}
	}
	else_if = {
		limit = { has_idea = TRK_russian_economic_hegemony_karaulbegi_nationalization }
		swap_ideas = {
			remove_idea = TRK_russian_economic_hegemony_karaulbegi_nationalization
			add_idea = TRK_russian_economic_hegemony_karaulbegi_taxes_nationalization
		}
	}
}
TRK_remove_british_mission = {
	clr_country_flag = TRK_british_military_mission
	every_other_country = {
		limit = {
			OR = {
				tag = ENT
				tag = AFG
				tag = DEH
			}
		}
		diplomatic_relation = {
			country = CAN
			relation = non_aggression_pact
			active = no
		}
		diplomatic_relation = {
			country = CAN
			relation = military_access
			active = no
		}
		remove_opinion_modifier = {
			target = TRK
			modifier = TRK_british_mission
		}
	}
	remove_opinion_modifier = {
		target = ENT
		modifier = TRK_british_mission
	}
	remove_opinion_modifier = {
		target = DEH
		modifier = TRK_british_mission
	}
	random_unit_leader = {
		limit = { has_id = 65899 }
		set_nationality = DEH
	}
}
TRK_remove_russian_economic_hegemony = {
	effect_tooltip = { remove_ideas = TRK_russian_economic_hegemony }
	hidden_effect = {
		remove_ideas = {
			TRK_russian_economic_hegemony
			TRK_russian_economic_hegemony_1
			TRK_russian_economic_hegemony_1_taxes
			TRK_russian_economic_hegemony_2_taxes
			TRK_russian_economic_hegemony_1_taxes_nationalization
			TRK_russian_economic_hegemony_2_taxes_nationalization
			TRK_russian_economic_hegemony_1_nationalization
			TRK_russian_economic_hegemony_karaulbegi
			TRK_russian_economic_hegemony_karaulbegi_nationalization
			TRK_russian_economic_hegemony_karaulbegi_taxes
			TRK_russian_economic_hegemony_karaulbegi_taxes_nationalization
			TRK_russian_economic_hegemony_karaulbegi_embargo
			TRK_russian_economic_hegemony_karaulbegi_embargo_nationaliation
		}
		if = {
			limit = {
				AFG = {
					is_subject = yes
					custom_trigger_tooltip = {
						has_country_flag = DEH_subjugate_afghans
						tooltip = AFG_subjugated_by_DEH
					}
				}
			}
			DEH = {
				country_event = {
					id = bukhara.63
					days = 2
				}
			}
		}
	}
}
TRK_remove_stagnant_government_bureaucracy = {
	effect_tooltip = { remove_ideas = TRK_stagnant_government_bureaucracy }
	hidden_effect = {
		remove_ideas = {
			TRK_stagnant_government_bureaucracy
			TRK_stagnant_government_bureaucracy_1
			TRK_stagnant_government_bureaucracy_2
			TRK_stagnant_government_bureaucracy_3
			TRK_stagnant_government_bureaucracy_4
		}
	}
}
TRK_improve_bureaucracy = {
	if = {
		limit = { has_idea = TRK_stagnant_government_bureaucracy_4 }
		remove_ideas = TRK_stagnant_government_bureaucracy_4
	}
	else_if = {
		limit = { has_idea = TRK_stagnant_government_bureaucracy_3 }
		swap_ideas = {
			remove_idea = TRK_stagnant_government_bureaucracy_3
			add_idea = TRK_stagnant_government_bureaucracy_4
		}
	}
	else_if = {
		limit = { has_idea = TRK_stagnant_government_bureaucracy_2 }
		swap_ideas = {
			remove_idea = TRK_stagnant_government_bureaucracy_2
			add_idea = TRK_stagnant_government_bureaucracy_3
		}
	}
	else_if = {
		limit = { has_idea = TRK_stagnant_government_bureaucracy_1 }
		swap_ideas = {
			remove_idea = TRK_stagnant_government_bureaucracy_1
			add_idea = TRK_stagnant_government_bureaucracy_2
		}
	}
	else_if = {
		limit = { has_idea = TRK_stagnant_government_bureaucracy }
		swap_ideas = {
			remove_idea = TRK_stagnant_government_bureaucracy
			add_idea = TRK_stagnant_government_bureaucracy_1
		}
	}
}
TRK_remove_monarchist_ideas = {
	if = {
		limit = { has_idea = TRK_legacy_of_emir }
		remove_ideas = TRK_legacy_of_emir
	}
	if = {
		limit = { has_idea = TRK_legacy_of_emir_kushbegi }
		remove_ideas = TRK_legacy_of_emir_kushbegi
	}
	if = {
		limit = { has_idea = TRK_legacy_of_emir_karaulbegi }
		remove_ideas = TRK_legacy_of_emir_karaulbegi
	}
	if = {
		limit = { has_idea = TRK_minorities_persecuted }
		remove_ideas = TRK_minorities_persecuted
	}
	if = {
		limit = { has_idea = TRK_central_asian_mecca }
		remove_ideas = TRK_central_asian_mecca
	}
	if = {
		limit = { TRK_has_stagnant_government_bureaucracy = yes }
		TRK_remove_stagnant_government_bureaucracy = yes
	}		
}